<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sri Lanka 360¬∞ - Summer Edition</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'slate-50': '#f8fafc',
                        'slate-100': '#f1f5f9',
                        'slate-200': '#e2e8f0',
                        'slate-300': '#cbd5e1',
                        'slate-600': '#475569',
                        'slate-700': '#334155',
                        'slate-800': '#1e293b',
                        'slate-900': '#0f172a',
                        'blue-50': '#eff6ff',
                        'blue-100': '#dbeafe',
                        'blue-500': '#3b82f6',
                        'blue-600': '#2563eb',
                        'emerald-50': '#ecfdf5',
                        'emerald-100': '#d1fae5',
                        'emerald-500': '#10b981',
                        'amber-50': '#fffbeb',
                        'amber-100': '#fef3c7',
                        'violet-50': '#f5f3ff',
                        'violet-100': '#ede9fe',
                        'teal-50': '#f0fdfa',
                        'teal-100': '#ccfbf1'
                    },
                    fontFamily: {
                        'sans': ['Inter', 'system-ui', 'sans-serif'],
                        'display': ['Inter', 'system-ui', 'sans-serif']
                    }
                }
            }
        }
    </script>
    <style>
        .countdown-item {
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            border: 1px solid #cbd5e1;
        }
        .nav-item {
            transition: all 0.3s ease;
        }
        .nav-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .section-hidden {
            display: none;
        }
        .itinerary-day {
            transition: all 0.3s ease;
        }
        .itinerary-day:hover {
            transform: scale(1.02);
        }
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            backdrop-filter: blur(5px);
        }
        .modal-content {
            background-color: white;
            margin: 2% auto;
            padding: 0;
            border-radius: 12px;
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            animation: modalSlideIn 0.3s ease-out;
        }
        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-50px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        .modal-header {
            padding: 20px 24px;
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .modal-body {
            padding: 24px;
        }
        .close {
            color: #9ca3af;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            transition: color 0.2s;
        }
        .close:hover {
            color: #374151;
        }
    </style>
</head>
<body class="bg-slate-50 min-h-screen font-sans">
    <!-- Header -->
    <header class="relative h-64 md:h-80 overflow-hidden">
        <img src="https://strapi-imaginary.weroad.it/resource/webp-large/1131/viaggio-di-gruppo-in-sri-lanka.webp" 
             alt="Sri Lanka" 
             class="w-full h-full object-cover">
        <div class="absolute inset-0 bg-gradient-to-t from-slate-900/70 via-slate-900/40 to-slate-900/20 flex items-center justify-center">
            <div class="text-center text-white">
                <h1 class="text-3xl md:text-5xl font-bold mb-2 font-display tracking-tight">Sri Lanka 360¬∞</h1>
                <p class="text-base md:text-lg opacity-95 mb-4 uppercase tracking-widest font-medium">Summer Edition</p>
                <p class="text-sm md:text-base opacity-85 tracking-wide font-light">18 AGOSTO - 29 AGOSTO 2025</p>
            </div>
        </div>
    </header>

    <!-- Countdown -->
    <section class="py-4 px-4 bg-white border-b border-slate-200">
        <div class="max-w-4xl mx-auto text-center">
            <h2 class="text-lg font-medium mb-4 text-slate-800 uppercase tracking-wider">Countdown alla Partenza</h2>
            <div id="countdown" class="flex justify-center space-x-2 md:space-x-4">
                <div class="countdown-item rounded-lg p-3 text-center min-w-16 shadow-sm">
                    <div id="days" class="text-xl md:text-2xl font-bold text-slate-800">0</div>
                    <div class="text-xs md:text-sm text-slate-600 font-medium">Giorni</div>
                </div>
                <div class="countdown-item rounded-lg p-3 text-center min-w-16 shadow-sm">
                    <div id="hours" class="text-xl md:text-2xl font-bold text-slate-800">0</div>
                    <div class="text-xs md:text-sm text-slate-600 font-medium">Ore</div>
                </div>
                <div class="countdown-item rounded-lg p-3 text-center min-w-16 shadow-sm">
                    <div id="minutes" class="text-xl md:text-2xl font-bold text-slate-800">0</div>
                    <div class="text-xs md:text-sm text-slate-600 font-medium">Min</div>
                </div>
                <div class="countdown-item rounded-lg p-3 text-center min-w-16 shadow-sm">
                    <div id="seconds" class="text-xl md:text-2xl font-bold text-slate-800">0</div>
                    <div class="text-xs md:text-sm text-slate-600 font-medium">Sec</div>
                </div>
            </div>
        </div>
    </section>

    <!-- Info Cards -->
    <section class="py-4 px-4 bg-slate-100">
        <div class="max-w-4xl mx-auto grid grid-cols-1 md:grid-cols-3 gap-3">
            <div class="bg-white rounded-lg p-4 text-center shadow-sm border border-slate-200">
                <div class="text-lg font-bold text-slate-800 mb-1">12</div>
                <div class="text-xs text-slate-600 font-medium">üìÖ Giorni</div>
            </div>
            <div class="bg-white rounded-lg p-4 text-center shadow-sm border border-slate-200">
                <div class="text-lg font-bold text-slate-800 mb-1">13</div>
                <div class="text-xs text-slate-600 font-medium">üë• Persone</div>
            </div>
            <div class="bg-white rounded-lg p-4 text-center shadow-sm border border-slate-200">
                <div class="text-lg font-bold text-slate-800 mb-1">‚àû</div>
                <div class="text-xs text-slate-600 font-medium">üéØ Attivit√†</div>
            </div>
        </div>
    </section>

    <!-- Navigation -->
    <nav class="py-8 px-4 bg-white">
        <div class="max-w-6xl mx-auto">
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                <button onclick="openModal('dashboard')" class="nav-item bg-slate-50 hover:bg-blue-50 rounded-xl p-4 text-center shadow-sm border border-slate-200 hover:border-blue-200 transition-all duration-200">
                    <div class="text-2xl mb-2">üè†</div>
                    <div class="text-sm font-medium text-slate-700">Dashboard</div>
                </button>
                <button onclick="openModal('intro')" class="nav-item bg-slate-50 hover:bg-blue-50 rounded-xl p-4 text-center shadow-sm border border-slate-200 hover:border-blue-200 transition-all duration-200">
                    <div class="text-2xl mb-2">üìñ</div>
                    <div class="text-sm font-medium text-slate-700">Intro</div>
                </button>
                <button onclick="openModal('guida')" class="nav-item bg-slate-50 hover:bg-blue-50 rounded-xl p-4 text-center shadow-sm border border-slate-200 hover:border-blue-200 transition-all duration-200">
                    <div class="text-2xl mb-2">üèõÔ∏è</div>
                    <div class="text-sm font-medium text-slate-700">Guida SL</div>
                </button>
                <button onclick="openModal('itinerario')" class="nav-item bg-slate-50 hover:bg-blue-50 rounded-xl p-4 text-center shadow-sm border border-slate-200 hover:border-blue-200 transition-all duration-200">
                    <div class="text-2xl mb-2">üó∫Ô∏è</div>
                    <div class="text-sm font-medium text-slate-700">Itinerario</div>
                </button>
                <button onclick="openModal('voli')" class="nav-item bg-slate-50 hover:bg-blue-50 rounded-xl p-4 text-center shadow-sm border border-slate-200 hover:border-blue-200 transition-all duration-200">
                    <div class="text-2xl mb-2">‚úàÔ∏è</div>
                    <div class="text-sm font-medium text-slate-700">Voli</div>
                </button>
                <button onclick="openModal('packing')" class="nav-item bg-slate-50 hover:bg-blue-50 rounded-xl p-4 text-center shadow-sm border border-slate-200 hover:border-blue-200 transition-all duration-200">
                    <div class="text-2xl mb-2">üéí</div>
                    <div class="text-sm font-medium text-slate-700">Packing List</div>
                </button>
                <button onclick="openModal('checklist')" class="nav-item bg-slate-50 hover:bg-blue-50 rounded-xl p-4 text-center shadow-sm border border-slate-200 hover:border-blue-200 transition-all duration-200">
                    <div class="text-2xl mb-2">‚úÖ</div>
                    <div class="text-sm font-medium text-slate-700">Checklist</div>
                </button>
                <button onclick="openModal('fun')" class="nav-item bg-slate-50 hover:bg-blue-50 rounded-xl p-4 text-center shadow-sm border border-slate-200 hover:border-blue-200 transition-all duration-200">
                    <div class="text-2xl mb-2">üéÆ</div>
                    <div class="text-sm font-medium text-slate-700">Fun Zone</div>
                </button>
                <button onclick="openModal('cassa')" class="nav-item bg-slate-50 hover:bg-blue-50 rounded-xl p-4 text-center shadow-sm border border-slate-200 hover:border-blue-200 transition-all duration-200">
                    <div class="text-2xl mb-2">üí∞</div>
                    <div class="text-sm font-medium text-slate-700">Cassa Comune</div>
                </button>
                <button onclick="openModal('contatti')" class="nav-item bg-slate-50 hover:bg-blue-50 rounded-xl p-4 text-center shadow-sm border border-slate-200 hover:border-blue-200 transition-all duration-200">
                    <div class="text-2xl mb-2">üìû</div>
                    <div class="text-sm font-medium text-slate-700">Info & Contatti</div>
                </button>
                <button onclick="openModal('chisiamo')" class="nav-item bg-slate-50 hover:bg-blue-50 rounded-xl p-4 text-center shadow-sm border border-slate-200 hover:border-blue-200 transition-all duration-200">
                    <div class="text-2xl mb-2">üôã‚Äç‚ôÄÔ∏è</div>
                    <div class="text-sm font-medium text-slate-700">Chi Siamo</div>
                </button>
                <button onclick="openModal('foto')" class="nav-item bg-slate-50 hover:bg-blue-50 rounded-xl p-4 text-center shadow-sm border border-slate-200 hover:border-blue-200 transition-all duration-200">
                    <div class="text-2xl mb-2">üì∏</div>
                    <div class="text-sm font-medium text-slate-700">Foto</div>
                </button>
                <button onclick="openModal('alimentari')" class="nav-item bg-slate-50 hover:bg-blue-50 rounded-xl p-4 text-center shadow-sm border border-slate-200 hover:border-blue-200 transition-all duration-200">
                    <div class="text-2xl mb-2">üçΩÔ∏è</div>
                    <div class="text-sm font-medium text-slate-700">Preferenze Cibo</div>
                </button>
                <button onclick="openModal('app')" class="nav-item bg-slate-50 hover:bg-blue-50 rounded-xl p-4 text-center shadow-sm border border-slate-200 hover:border-blue-200 transition-all duration-200">
                    <div class="text-2xl mb-2">üì±</div>
                    <div class="text-sm font-medium text-slate-700">App Utili</div>
                </button>
            </div>
        </div>
    </nav>

    <!-- Modal -->
    <div id="contentModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle" class="text-lg font-medium text-gray-800 uppercase tracking-wide"></h2>
                <span class="close" onclick="closeModal()">&times;</span>
            </div>
            <div class="modal-body">
                <div id="modalContent"></div>
            </div>
        </div>
    </div>

    <!-- Content Sections -->
    <main class="px-4 pb-8">
        <div class="max-w-4xl mx-auto">
            
            <!-- Dashboard -->
            <section id="dashboard" class="bg-white rounded-xl p-8 shadow-sm border border-slate-200">
                <h2 class="text-xl font-semibold mb-6 text-slate-800 uppercase tracking-wider">Dashboard</h2>
                <div class="space-y-6">
                    <div class="bg-blue-50 rounded-xl p-6 border border-blue-100">
                        <h3 class="font-semibold text-slate-800 mb-3">Benvenuti nel vostro hub di viaggio!</h3>
                        <p class="text-slate-600">Qui troverete tutte le informazioni essenziali per il nostro viaggio in Sri Lanka. Utilizzate il menu sopra per navigare tra le diverse sezioni.</p>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div class="bg-emerald-50 rounded-xl p-6 border border-emerald-100">
                            <h4 class="font-semibold text-slate-800 mb-3">Prossimi Step</h4>
                            <ul class="text-slate-600 space-y-1">
                                <li>‚Ä¢ Controllare la checklist</li>
                                <li>‚Ä¢ Preparare i documenti</li>
                                <li>‚Ä¢ Fare la valigia</li>
                                <li>‚Ä¢ Compilare excel per info su arrivo e partenze</li>
                            </ul>
                        </div>
                        <div class="bg-amber-50 rounded-xl p-6 border border-amber-100">
                            <h4 class="font-semibold text-slate-800 mb-3">Contatti Rapidi</h4>
                            <p class="text-slate-700 font-medium">Sabrina (Coordinatrice)</p>
                            <p class="text-sm text-slate-600"><a href="tel:+393477257071" class="text-blue-600 hover:text-blue-800 underline">+39 3477257071</a></p>
                            <p class="text-sm text-slate-600"><a href="mailto:cocosabrina.wr@gmail.com" class="text-blue-600 hover:text-blue-800 underline">cocosabrina.wr@gmail.com</a></p>
                            <p class="text-sm text-slate-600"><a href="mailto:sabrina_coco@hotmail.it" class="text-blue-600 hover:text-blue-800 underline">sabrina_coco@hotmail.it</a></p>
                            <p class="text-sm text-slate-600">üì∏ <a href="https://instagram.com/awild.coco" target="_blank" class="text-blue-600 hover:text-blue-800 underline">@awild.coco</a> (Instagram)</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Fun Zone -->
            <section id="fun" class="bg-white rounded-xl p-8 shadow-sm border border-slate-200 section-hidden">
                <h2 class="text-xl font-semibold mb-6 text-slate-800 uppercase tracking-wider">üéÆ Fun Zone</h2>
                
                <!-- Navigation Tabs -->
                <div class="flex flex-wrap gap-2 mb-6">
                    <button onclick="showFunSection('minivan')" id="tab-minivan" class="fun-tab active bg-blue-600 text-white px-4 py-2 rounded-lg font-medium transition-colors">
                        üöê Minivan
                    </button>
                    <button onclick="showFunSection('shuffle')" id="tab-shuffle" class="fun-tab bg-slate-200 text-slate-700 hover:bg-slate-300 px-4 py-2 rounded-lg font-medium transition-colors">
                        üîÄ Shuffle
                    </button>
                    <button onclick="showFunSection('daily')" id="tab-daily" class="fun-tab bg-slate-200 text-slate-700 hover:bg-slate-300 px-4 py-2 rounded-lg font-medium transition-colors">
                        üí≠ Domanda del Giorno
                    </button>
                    <button onclick="showFunSection('awards')" id="tab-awards" class="fun-tab bg-slate-200 text-slate-700 hover:bg-slate-300 px-4 py-2 rounded-lg font-medium transition-colors">
                        üèÜ Awards
                    </button>
                    <button onclick="showFunSection('camere')" id="tab-camere" class="fun-tab bg-slate-200 text-slate-700 hover:bg-slate-300 px-4 py-2 rounded-lg font-medium transition-colors">
                        üè® Camere
                    </button>
                    <button onclick="showFunSection('quiz')" id="tab-quiz" class="fun-tab bg-slate-200 text-slate-700 hover:bg-slate-300 px-4 py-2 rounded-lg font-medium transition-colors">
                        üß† Quiz
                    </button>
                    <button onclick="showFunSection('diario')" id="tab-diario" class="fun-tab bg-slate-200 text-slate-700 hover:bg-slate-300 px-4 py-2 rounded-lg font-medium transition-colors">
                        üìñ Diario
                    </button>
                    <button onclick="showFunSection('indovina')" id="tab-indovina" class="fun-tab bg-slate-200 text-slate-700 hover:bg-slate-300 px-4 py-2 rounded-lg font-medium transition-colors">
                        üïµÔ∏è Indovina Chi?
                    </button>
                </div>

                <!-- Minivan Section -->
                <div id="fun-minivan" class="fun-content">
                    <div class="bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-6 border border-blue-200">
                        <h3 class="font-semibold text-slate-800 mb-4">üöê Il Nostro Minivan</h3>
                        <p class="text-slate-600 mb-4">Benvenuti nella vostra nuova casa mobile per 12 giorni! Il minivan sar√† testimone di tutto: dalle vostre battute geniali alle vostre crisi esistenziali, dai vostri momenti di gloria ai vostri epic fail. Preparatevi a conoscervi MOLTO bene! üòÖ</p>
                        
                        <div class="bg-white rounded-xl p-4 border border-slate-200">
                            <h4 class="font-medium text-slate-800 mb-3">üìã Le Uniche Regole che Contano</h4>
                            <ul class="text-sm text-slate-600 space-y-2">
                                <li>‚Ä¢ üéµ <strong>Playlist condivisa</strong> - Ognuno pu√≤ aggiungere le proprie canzoni (ma se metti "Despacito" per la 47¬™ volta, ti lasciamo a piedi)<br>
                                    <a href="https://open.spotify.com/playlist/5qwzkt20qQqHCKMc3p4cg3?si=bnVoh_P_QPWI-qGJ3rAbrg&pt=56f0e50a77d8744e2ff72d779282d8c5" target="_blank" class="inline-block mt-2 bg-green-600 hover:bg-green-700 text-white px-3 py-1 rounded-lg text-xs font-medium transition-colors">
                                        üéß Apri Playlist Spotify
                                    </a>
                                </li>
                                <li>‚Ä¢ üì± <strong>Foto di gruppo</strong> - Almeno una foto tutti insieme ogni giorno (anche quando sembrate zombie)</li>
                                <li>‚Ä¢ üßπ <strong>Pulizia</strong> - Lasciamo il minivan come lo abbiamo trovato (o almeno proviamoci)</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Diario Section -->
                <div id="fun-diario" class="fun-content hidden">
                    <div class="bg-gradient-to-r from-orange-50 to-yellow-50 rounded-xl p-6 border border-orange-200">
                        <h3 class="font-semibold text-slate-800 mb-4">üìñ Mini Diario di Bordo</h3>
                        <div class="bg-white rounded-xl p-4 border border-orange-200 mb-6">
                            <p class="text-slate-600 mb-4">
                                Il posto dove immortalare i momenti epici, i fail memorabili e le rivelazioni esistenziali che vi colpiranno tra un curry e l'altro! üå∂Ô∏èüí≠
                            </p>
                            <p class="text-slate-600 mb-4">
                                Che sia "Ho appena visto il tramonto pi√π bello della mia vita" o "Aiuto, ho mangiato qualcosa che mi ha fatto vedere gli elefanti rosa", questo √® il vostro spazio per condividere tutto quello che vi passa per la testa! 
                            </p>
                            <p class="text-sm text-slate-500 italic">
                                üí° Modalit√† ninja attivata: puoi scrivere in anonimo se hai fatto qualcosa di imbarazzante ma troppo divertente per non condividerlo! ü•∑
                            </p>
                        </div>
                        
                        <!-- Entries Display -->
                        <div id="funDiaryEntriesContainer" class="space-y-4 mb-6">
                            <!-- Le entries verranno aggiunte qui dinamicamente -->
                        </div>
                        
                        <!-- Add New Entry Form -->
                        <div class="bg-white rounded-xl p-4 border border-orange-200">
                            <h4 class="font-medium text-slate-800 mb-4">‚úçÔ∏è Scrivi nel Diario</h4>
                            <div class="space-y-3">
                                <div>
                                    <label class="block text-sm font-medium text-slate-700 mb-1">Il tuo messaggio</label>
                                    <textarea id="funDiaryMessage" placeholder="Racconta questo momento del viaggio..." rows="4"
                                              class="w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent resize-none text-sm"></textarea>
                                </div>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                                    <div>
                                        <label class="block text-sm font-medium text-slate-700 mb-1">Il tuo nome</label>
                                        <input type="text" id="funDiaryAuthor" placeholder="Il tuo nome (opzionale - lascia vuoto per essere anonimo)" 
                                               class="w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent text-sm">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-slate-700 mb-1">Dove siamo? (opzionale)</label>
                                        <input type="text" id="funDiaryLocation" placeholder="es. Galle Fort, Ella..." 
                                               class="w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent text-sm">
                                    </div>
                                </div>
                                <button onclick="addFunDiaryEntry()" 
                                        class="w-full bg-orange-600 hover:bg-orange-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200 text-sm">
                                    üìù Aggiungi al Diario
                                </button>
                            </div>
                        </div>
                        
                        <!-- Export Diary -->
                        <div class="bg-white rounded-xl p-4 border border-orange-200 mt-4">
                            <h4 class="font-medium text-slate-800 mb-2">üì§ Esporta Diario</h4>
                            <p class="text-sm text-slate-600 mb-3">Salva tutti i ricordi del gruppo in un unico documento!</p>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-2">
                                <button onclick="exportDiary()" 
                                        class="bg-slate-600 hover:bg-slate-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200 text-sm">
                                    üíæ Scarica TXT
                                </button>
                                <button onclick="exportDiaryPDF()" 
                                        class="bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200 text-sm">
                                    üìÑ Scarica PDF
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Indovina Chi Section -->
                <div id="fun-indovina" class="fun-content hidden">
                    <div class="bg-gradient-to-r from-purple-50 to-indigo-50 rounded-xl p-6 border border-purple-200">
                        <h3 class="font-semibold text-slate-800 mb-4">üïµÔ∏è Indovina Chi?</h3>
                        
                        <!-- Password Protection -->
                        <div id="indovinaPasswordSection" class="bg-white rounded-xl p-6 border border-purple-200 text-center">
                            <div class="text-4xl mb-4">üîê</div>
                            <h4 class="text-lg font-semibold text-slate-800 mb-3">Sezione Protetta</h4>
                            <p class="text-slate-600 mb-6">Questa sezione √® riservata! Inserisci la password per accedere.</p>
                            
                            <div class="max-w-sm mx-auto space-y-4">
                                <input type="password" 
                                       id="indovinaPassword" 
                                       placeholder="Inserisci la password..." 
                                       class="w-full px-4 py-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent text-center"
                                       onkeypress="if(event.key==='Enter') checkIndovinaPassword()">
                                
                                <button onclick="checkIndovinaPassword()" 
                                        class="w-full bg-purple-600 hover:bg-purple-700 text-white font-medium py-3 px-4 rounded-lg transition-colors duration-200">
                                    üîì Accedi
                                </button>
                            </div>
                            
                            <div id="indovinaPasswordError" class="hidden mt-4 text-red-600 text-sm">
                                ‚ùå Password errata! Riprova...
                            </div>
                        </div>
                        
                        <!-- Protected Content (hidden by default) -->
                        <div id="indovinaContent" class="hidden">
                            <div class="bg-white rounded-xl p-6 border border-purple-200 mb-6">
                                <div class="text-center mb-6">
                                    <div class="text-4xl mb-3">üé≠</div>
                                    <h4 class="text-lg font-semibold text-slate-800 mb-2">Benvenuti nella Sezione Segreta!</h4>
                                    <p class="text-slate-600">Qui potrete condividere segreti, curiosit√† e indovinelli sul gruppo! ü§´</p>
                                </div>
                                
                                <!-- Placeholder content - to be filled during the trip -->
                                <div class="bg-gradient-to-r from-purple-50 to-pink-50 rounded-xl p-6 border border-purple-200">
                                    <h5 class="font-semibold text-slate-800 mb-4">üöß Sezione in Costruzione</h5>
                                    <p class="text-slate-600 mb-4">
                                        Questa sezione sar√† riempita durante il viaggio con contenuti speciali! 
                                        Potrebbe includere:
                                    </p>
                                    <ul class="text-slate-600 space-y-2 mb-4">
                                        <li>‚Ä¢ üéØ Indovinelli sui membri del gruppo</li>
                                        <li>‚Ä¢ ü§´ Segreti divertenti condivisi</li>
                                        <li>‚Ä¢ üé≠ Giochi di ruolo e sfide</li>
                                        <li>‚Ä¢ üì∏ Foto misteriose da indovinare</li>
                                        <li>‚Ä¢ üèÜ Classifiche segrete</li>
                                    </ul>
                                    <p class="text-sm text-slate-500 italic">
                                        üí° Sabrina aggiunger√† contenuti speciali qui durante il viaggio!
                                    </p>
                                </div>
                                
                                <!-- Future content area -->
                                <div id="indovinaGameContent" class="mt-6">
                                    <!-- Content will be added here during the trip -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Other sections would go here... -->
                <div id="fun-shuffle" class="fun-content hidden">
                    <div class="bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl p-6 border border-green-200">
                        <h3 class="font-semibold text-slate-800 mb-4">üîÄ Shuffle Mode</h3>
                        <p class="text-slate-600 mb-4">Funzionalit√† in arrivo...</p>
                    </div>
                </div>

                <div id="fun-daily" class="fun-content hidden">
                    <div class="bg-gradient-to-r from-yellow-50 to-amber-50 rounded-xl p-6 border border-yellow-200">
                        <h3 class="font-semibold text-slate-800 mb-4">üí≠ Domanda del Giorno</h3>
                        <p class="text-slate-600 mb-4">Funzionalit√† in arrivo...</p>
                    </div>
                </div>

                <div id="fun-awards" class="fun-content hidden">
                    <div class="bg-gradient-to-r from-amber-50 to-orange-50 rounded-xl p-6 border border-amber-200">
                        <h3 class="font-semibold text-slate-800 mb-4">üèÜ Awards</h3>
                        <p class="text-slate-600 mb-4">Funzionalit√† in arrivo...</p>
                    </div>
                </div>

                <div id="fun-camere" class="fun-content hidden">
                    <div class="bg-gradient-to-r from-pink-50 to-rose-50 rounded-xl p-6 border border-pink-200">
                        <h3 class="font-semibold text-slate-800 mb-4">üè® Camere</h3>
                        <p class="text-slate-600 mb-4">Funzionalit√† in arrivo...</p>
                    </div>
                </div>

                <div id="fun-quiz" class="fun-content hidden">
                    <div class="bg-gradient-to-r from-indigo-50 to-purple-50 rounded-xl p-6 border border-indigo-200">
                        <h3 class="font-semibold text-slate-800 mb-4">üß† Quiz</h3>
                        <p class="text-slate-600 mb-4">Funzionalit√† in arrivo...</p>
                    </div>
                </div>
            </section>

            <!-- Other sections would be added here... -->
            <section id="intro" class="bg-white rounded-xl p-8 shadow-sm border border-slate-200 section-hidden">
                <h2 class="text-xl font-semibold mb-6 text-slate-800 uppercase tracking-wider">Intro</h2>
                <p class="text-slate-600">Sezione intro in costruzione...</p>
            </section>

            <section id="guida" class="bg-white rounded-xl p-8 shadow-sm border border-slate-200 section-hidden">
                <h2 class="text-xl font-semibold mb-6 text-slate-800 uppercase tracking-wider">Guida SL</h2>
                <p class="text-slate-600">Guida Sri Lanka in costruzione...</p>
            </section>

            <section id="itinerario" class="bg-white rounded-xl p-8 shadow-sm border border-slate-200 section-hidden">
                <h2 class="text-xl font-semibold mb-6 text-slate-800 uppercase tracking-wider">Itinerario</h2>
                <p class="text-slate-600">Itinerario in costruzione...</p>
            </section>

            <section id="voli" class="bg-white rounded-xl p-8 shadow-sm border border-slate-200 section-hidden">
                <h2 class="text-xl font-semibold mb-6 text-slate-800 uppercase tracking-wider">Voli</h2>
                <p class="text-slate-600">Informazioni voli in costruzione...</p>
            </section>

            <section id="packing" class="bg-white rounded-xl p-8 shadow-sm border border-slate-200 section-hidden">
                <h2 class="text-xl font-semibold mb-6 text-slate-800 uppercase tracking-wider">Packing List</h2>
                <p class="text-slate-600">Packing list in costruzione...</p>
            </section>

            <section id="checklist" class="bg-white rounded-xl p-8 shadow-sm border border-slate-200 section-hidden">
                <h2 class="text-xl font-semibold mb-6 text-slate-800 uppercase tracking-wider">Checklist</h2>
                <p class="text-slate-600">Checklist in costruzione...</p>
            </section>

            <section id="cassa" class="bg-white rounded-xl p-8 shadow-sm border border-slate-200 section-hidden">
                <h2 class="text-xl font-semibold mb-6 text-slate-800 uppercase tracking-wider">Cassa Comune</h2>
                <p class="text-slate-600">Cassa comune in costruzione...</p>
            </section>

            <section id="contatti" class="bg-white rounded-xl p-8 shadow-sm border border-slate-200 section-hidden">
                <h2 class="text-xl font-semibold mb-6 text-slate-800 uppercase tracking-wider">Info & Contatti</h2>
                <p class="text-slate-600">Contatti in costruzione...</p>
            </section>

            <section id="chisiamo" class="bg-white rounded-xl p-8 shadow-sm border border-slate-200 section-hidden">
                <h2 class="text-xl font-semibold mb-6 text-slate-800 uppercase tracking-wider">Chi Siamo</h2>
                <p class="text-slate-600">Chi siamo in costruzione...</p>
            </section>

            <section id="foto" class="bg-white rounded-xl p-8 shadow-sm border border-slate-200 section-hidden">
                <h2 class="text-xl font-semibold mb-6 text-slate-800 uppercase tracking-wider">Foto</h2>
                <p class="text-slate-600">Galleria foto in costruzione...</p>
            </section>

            <section id="alimentari" class="bg-white rounded-xl p-8 shadow-sm border border-slate-200 section-hidden">
                <h2 class="text-xl font-semibold mb-6 text-slate-800 uppercase tracking-wider">Preferenze Cibo</h2>
                <p class="text-slate-600">Preferenze alimentari in costruzione...</p>
            </section>

            <section id="app" class="bg-white rounded-xl p-8 shadow-sm border border-slate-200 section-hidden">
                <h2 class="text-xl font-semibold mb-6 text-slate-800 uppercase tracking-wider">App Utili</h2>
                <p class="text-slate-600">App utili in costruzione...</p>
            </section>

        </div>
    </main>

    <script>
        // Countdown Timer
        function updateCountdown() {
            const targetDate = new Date('2025-08-18T00:00:00').getTime();
            const now = new Date().getTime();
            const difference = targetDate - now;

            const days = Math.floor(difference / (1000 * 60 * 60 * 24));
            const hours = Math.floor((difference % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((difference % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((difference % (1000 * 60)) / 1000);

            document.getElementById('days').textContent = days;
            document.getElementById('hours').textContent = hours;
            document.getElementById('minutes').textContent = minutes;
            document.getElementById('seconds').textContent = seconds;
        }

        setInterval(updateCountdown, 1000);
        updateCountdown();

        // Modal Functions
        function openModal(sectionId) {
            const modal = document.getElementById('contentModal');
            const modalTitle = document.getElementById('modalTitle');
            const modalContent = document.getElementById('modalContent');
            
            // Get the section content
            const section = document.getElementById(sectionId);
            const sectionTitle = section.querySelector('h2').textContent;
            const sectionContent = section.innerHTML;
            
            // Create a temporary div to manipulate the content
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = sectionContent;
            
            // Remove the h2 title from the content since it's already in the modal header
            const h2Element = tempDiv.querySelector('h2');
            if (h2Element) {
                h2Element.remove();
            }
            
            // Set modal content
            modalTitle.textContent = sectionTitle;
            modalContent.innerHTML = tempDiv.innerHTML;
            
            // Show modal
            modal.style.display = 'block';
            document.body.style.overflow = 'hidden'; // Prevent background scrolling
            
            // If it's the fun zone, initialize the first tab
            if (sectionId === 'fun') {
                setTimeout(() => {
                    showFunSection('minivan');
                    loadDiaryEntries(); // Load diary entries when opening fun zone
                }, 100);
            }
        }

        function closeModal() {
            const modal = document.getElementById('contentModal');
            modal.style.display = 'none';
            document.body.style.overflow = 'auto'; // Restore scrolling
        }

        // Close modal when clicking outside
        window.onclick = function(event) {
            const modal = document.getElementById('contentModal');
            if (event.target === modal) {
                closeModal();
            }
        }

        // Close modal with Escape key
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                closeModal();
            }
        });

        // Fun Zone Tab Navigation
        function showFunSection(section) {
            // Hide all content sections
            const contents = document.querySelectorAll('.fun-content');
            contents.forEach(content => content.classList.add('hidden'));
            
            // Remove active class from all tabs
            const tabs = document.querySelectorAll('.fun-tab');
            tabs.forEach(tab => {
                tab.classList.remove('active', 'bg-blue-600', 'text-white');
                tab.classList.add('bg-slate-200', 'text-slate-700', 'hover:bg-slate-300');
            });
            
            // Show selected content
            const targetContent = document.getElementById(`fun-${section}`);
            if (targetContent) {
                targetContent.classList.remove('hidden');
            }
            
            // Activate selected tab
            const activeTab = document.getElementById(`tab-${section}`);
            if (activeTab) {
                activeTab.classList.remove('bg-slate-200', 'text-slate-700', 'hover:bg-slate-300');
                activeTab.classList.add('active', 'bg-blue-600', 'text-white');
            }
            
            // Load diary entries if switching to diary section
            if (section === 'diario') {
                setTimeout(() => {
                    loadDiaryEntries();
                }, 100);
            }
        }

        // Diary Management Functions - FIXED VERSION
        function loadDiaryEntries() {
            try {
                const entries = JSON.parse(localStorage.getItem('sriLankaDiary') || '[]');
                console.log('Loading diary entries:', entries.length);
                
                // Try to find container in modal first, then in main page
                let container = document.querySelector('#contentModal #funDiaryEntriesContainer');
                if (!container) {
                    container = document.getElementById('funDiaryEntriesContainer');
                }
                
                if (!container) {
                    console.log('Container not found');
                    return;
                }
                
                container.innerHTML = '';
                
                if (entries.length === 0) {
                    container.innerHTML = `
                        <div class="text-center text-slate-500 py-8">
                            <div class="text-4xl mb-3">üìñ</div>
                            <p>Il diario √® ancora vuoto...</p>
                            <p class="text-sm mt-2">Sii il primo a condividere un ricordo! ‚ú®</p>
                        </div>
                    `;
                    return;
                }
                
                // Sort entries by date (newest first)
                const sortedEntries = [...entries].sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
                
                sortedEntries.forEach((entry) => {
                    const entryCard = document.createElement('div');
                    entryCard.className = 'bg-white rounded-xl p-4 border border-orange-200 shadow-sm';
                    
                    const entryDate = new Date(entry.timestamp);
                    const formattedDate = entryDate.toLocaleDateString('it-IT', { 
                        weekday: 'long', 
                        year: 'numeric', 
                        month: 'long', 
                        day: 'numeric',
                        hour: '2-digit',
                        minute: '2-digit'
                    });
                    
                    entryCard.innerHTML = `
                        <div class="flex justify-between items-start mb-3">
                            <div class="flex-1">
                                <div class="flex items-center space-x-2 mb-1">
                                    <span class="font-semibold text-slate-800 text-sm">‚úçÔ∏è ${entry.author}</span>
                                    ${entry.location ? `<span class="text-xs bg-orange-100 px-2 py-1 rounded-full text-orange-700">üìç ${entry.location}</span>` : ''}
                                </div>
                                <div class="text-xs text-slate-500">${formattedDate}</div>
                            </div>
                            <button onclick="confirmDeleteDiaryEntry('${entry.id}')" 
                                    class="text-slate-400 hover:text-red-500 transition-colors text-sm ml-2 p-1 rounded hover:bg-red-50"
                                    title="Elimina questo post">
                                üóëÔ∏è
                            </button>
                        </div>
                        <div class="text-sm text-slate-700 leading-relaxed whitespace-pre-wrap">${entry.message}</div>
                    `;
                    container.appendChild(entryCard);
                });
                
                console.log('Diary entries loaded successfully');
            } catch (error) {
                console.error('Error loading diary entries:', error);
            }
        }

        function addFunDiaryEntry() {
            // Try to get elements from both modal and main page
            let message = document.getElementById('funDiaryMessage')?.value?.trim();
            let author = document.getElementById('funDiaryAuthor')?.value?.trim();
            let location = document.getElementById('funDiaryLocation')?.value?.trim();
            
            // If not found in modal, try to find in the cloned content
            if (!message) {
                const modalMessage = document.querySelector('#contentModal #funDiaryMessage');
                const modalAuthor = document.querySelector('#contentModal #funDiaryAuthor');
                const modalLocation = document.querySelector('#contentModal #funDiaryLocation');
                
                if (modalMessage) message = modalMessage.value?.trim();
                if (modalAuthor) author = modalAuthor.value?.trim();
                if (modalLocation) location = modalLocation.value?.trim();
            }

            if (!message) {
                alert('Per favore scrivi almeno un messaggio!');
                return;
            }

            try {
                const entries = JSON.parse(localStorage.getItem('sriLankaDiary') || '[]');
                
                const newEntry = {
                    message,
                    author: author || 'Viaggiatore Anonimo',
                    location: location || null,
                    timestamp: new Date().toISOString(),
                    id: Date.now().toString() + '_' + Math.random().toString(36).substr(2, 9)
                };

                entries.push(newEntry);
                localStorage.setItem('sriLankaDiary', JSON.stringify(entries));
                
                console.log('Entry saved:', newEntry);
                console.log('Total entries:', entries.length);

                clearFunDiaryForm();
                loadDiaryEntries();
                showFunDiarySuccessMessage();
            } catch (error) {
                console.error('Error saving diary entry:', error);
                alert('Errore nel salvare il messaggio. Riprova!');
            }
        }

        function clearFunDiaryForm() {
            // Clear both original and modal elements
            const messageEl = document.getElementById('funDiaryMessage');
            const authorEl = document.getElementById('funDiaryAuthor');
            const locationEl = document.getElementById('funDiaryLocation');
            
            const modalMessage = document.querySelector('#contentModal #funDiaryMessage');
            const modalAuthor = document.querySelector('#contentModal #funDiaryAuthor');
            const modalLocation = document.querySelector('#contentModal #funDiaryLocation');
            
            if (messageEl) messageEl.value = '';
            if (authorEl) authorEl.value = '';
            if (locationEl) locationEl.value = '';
            
            if (modalMessage) modalMessage.value = '';
            if (modalAuthor) modalAuthor.value = '';
            if (modalLocation) modalLocation.value = '';
        }

        function showFunDiarySuccessMessage() {
            const button = document.querySelector('button[onclick="addFunDiaryEntry()"]');
            if (button) {
                const originalText = button.innerHTML;
                button.innerHTML = '‚úÖ Aggiunto al diario!';
                button.className = 'w-full bg-green-600 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200 text-sm';
                
                setTimeout(() => {
                    button.innerHTML = originalText;
                    button.className = 'w-full bg-orange-600 hover:bg-orange-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200 text-sm';
                }, 2000);
            }
        }

        // Password-protected section functions
        function checkIndovinaPassword() {
            const password = document.getElementById('indovinaPassword').value;
            const correctPassword = '@Fiori2025';
            
            if (password === correctPassword) {
                // Hide password section
                document.getElementById('indovinaPasswordSection').classList.add('hidden');
                // Show protected content
                document.getElementById('indovinaContent').classList.remove('hidden');
                // Clear password field
                document.getElementById('indovinaPassword').value = '';
                // Hide error message
                document.getElementById('indovinaPasswordError').classList.add('hidden');
            } else {
                // Show error message
                document.getElementById('indovinaPasswordError').classList.remove('hidden');
                // Clear password field
                document.getElementById('indovinaPassword').value = '';
                // Add shake animation
                const passwordSection = document.getElementById('indovinaPasswordSection');
                passwordSection.style.animation = 'shake 0.5s';
                setTimeout(() => {
                    passwordSection.style.animation = '';
                }, 500);
            }
        }

        function confirmDeleteDiaryEntry(entryId) {
            const entries = JSON.parse(localStorage.getItem('sriLankaDiary') || '[]');
            const entry = entries.find(e => e.id === entryId);
            
            if (!entry) return;
            
            // Create custom confirmation modal
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            modal.innerHTML = `
                <div class="bg-white rounded-xl p-6 max-w-md mx-4 shadow-2xl">
                    <div class="text-center mb-6">
                        <div class="text-4xl mb-3">üóëÔ∏è</div>
                        <h3 class="text-lg font-semibold text-slate-800 mb-2">Elimina Post dal Diario</h3>
                        <p class="text-sm text-slate-600 mb-4">Sei sicuro di voler eliminare questo ricordo?</p>
                        
                        <div class="bg-slate-50 rounded-lg p-3 text-left mb-4">
                            <div class="text-xs text-slate-500 mb-1">
                                <strong>‚úçÔ∏è ${entry.author}</strong>
                                ${entry.location ? ` ‚Ä¢ üìç ${entry.location}` : ''}
                            </div>
                            <div class="text-sm text-slate-700 line-clamp-3">
                                "${entry.message.length > 100 ? entry.message.substring(0, 100) + '...' : entry.message}"
                            </div>
                        </div>
                        
                        <p class="text-xs text-red-600 font-medium">‚ö†Ô∏è Questa azione non pu√≤ essere annullata!</p>
                    </div>
                    
                    <div class="flex space-x-3">
                        <button onclick="cancelDeleteDiary()" 
                                class="flex-1 bg-slate-100 hover:bg-slate-200 text-slate-700 font-medium py-2 px-4 rounded-lg transition-colors">
                            ‚ùå Annulla
                        </button>
                        <button onclick="deleteDiaryEntry('${entryId}')" 
                                class="flex-1 bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-4 rounded-lg transition-colors">
                            üóëÔ∏è Elimina
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            document.body.style.overflow = 'hidden';
        }

        function cancelDeleteDiary() {
            const modal = document.querySelector('.fixed.inset-0.bg-black');
            if (modal) {
                document.body.removeChild(modal);
                document.body.style.overflow = 'auto';
            }
        }

        function deleteDiaryEntry(entryId) {
            const entries = JSON.parse(localStorage.getItem('sriLankaDiary') || '[]');
            const filteredEntries = entries.filter(entry => entry.id !== entryId);
            localStorage.setItem('sriLankaDiary', JSON.stringify(filteredEntries));
            
            // Close modal
            cancelDeleteDiary();
            
            // Reload entries
            loadDiaryEntries();
            
            // Show success message
            showDeleteSuccessMessage();
        }

        function showDeleteSuccessMessage() {
            // Create temporary success message
            const successDiv = document.createElement('div');
            successDiv.className = 'fixed top-4 right-4 bg-green-600 text-white px-4 py-2 rounded-lg shadow-lg z-50 transform transition-all duration-300';
            successDiv.innerHTML = '‚úÖ Post eliminato dal diario!';
            
            document.body.appendChild(successDiv);
            
            // Animate in
            setTimeout(() => {
                successDiv.style.transform = 'translateX(0)';
            }, 100);
            
            // Remove after 3 seconds
            setTimeout(() => {
                successDiv.style.transform = 'translateX(100%)';
                setTimeout(() => {
                    if (document.body.contains(successDiv)) {
                        document.body.removeChild(successDiv);
                    }
                }, 300);
            }, 3000);
        }

        // Export functions
        function exportDiary() {
            const entries = JSON.parse(localStorage.getItem('sriLankaDiary') || '[]');
            
            if (entries.length === 0) {
                alert('Il diario √® vuoto! Aggiungi qualche ricordo prima di esportare.');
                return;
            }

            // Sort entries by date (oldest first for chronological order)
            entries.sort((a, b) => new Date(a.timestamp) - new Date(b.timestamp));

            let diaryContent = `üìñ DIARIO DI BORDO - SRI LANKA 360¬∞ SUMMER EDITION
üóìÔ∏è 18-29 Agosto 2025
üë• Gruppo WeRoad

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

`;

            entries.forEach((entry, index) => {
                const entryDate = new Date(entry.timestamp);
                const formattedDate = entryDate.toLocaleDateString('it-IT', { 
                    weekday: 'long', 
                    year: 'numeric', 
                    month: 'long', 
                    day: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                });

                diaryContent += `üìù ENTRY #${index + 1}
üìÖ ${formattedDate}
‚úçÔ∏è ${entry.author}`;

                if (entry.location) {
                    diaryContent += `\nüìç ${entry.location}`;
                }

                diaryContent += `\n\n${entry.message}\n\n`;
                diaryContent += `‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n\n`;
            });

            diaryContent += `üéØ STATISTICHE DIARIO:
‚Ä¢ Totale entries: ${entries.length}
‚Ä¢ Primo ricordo: ${new Date(entries[0].timestamp).toLocaleDateString('it-IT')}
‚Ä¢ Ultimo ricordo: ${new Date(entries[entries.length - 1].timestamp).toLocaleDateString('it-IT')}

üíù Generato automaticamente dal sistema Sri Lanka 360¬∞
üåç Un ricordo indimenticabile del nostro viaggio insieme!

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê`;

            // Create and download file
            const blob = new Blob([diaryContent], { type: 'text/plain;charset=utf-8' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `Diario_Sri_Lanka_${new Date().toISOString().split('T')[0]}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);

            // Show success message
            const button = document.querySelector('button[onclick="exportDiary()"]');
            if (button) {
                const originalText = button.innerHTML;
                button.innerHTML = '‚úÖ Diario scaricato!';
                button.className = 'bg-green-600 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200 text-sm';
                
                setTimeout(() => {
                    button.innerHTML = originalText;
                    button.className = 'bg-slate-600 hover:bg-slate-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200 text-sm';
                }, 3000);
            }
        }

        function exportDiaryPDF() {
            const entries = JSON.parse(localStorage.getItem('sriLankaDiary') || '[]');
            
            if (entries.length === 0) {
                alert('Il diario √® vuoto! Aggiungi qualche ricordo prima di esportare.');
                return;
            }

            // Check if jsPDF is available
            if (typeof window.jsPDF === 'undefined') {
                alert('Errore: libreria PDF non disponibile. Usa il download TXT.');
                return;
            }

            try {
                const { jsPDF } = window.jsPDF;
                const doc = new jsPDF();
                
                // Sort entries by date (oldest first for chronological order)
                entries.sort((a, b) => new Date(a.timestamp) - new Date(b.timestamp));

                // Title
                doc.setFontSize(20);
                doc.text('DIARIO DI BORDO', 20, 30);
                doc.setFontSize(16);
                doc.text('Sri Lanka 360¬∞ - Summer Edition', 20, 45);
                doc.setFontSize(12);
                doc.text('18-29 Agosto 2025 | Gruppo WeRoad', 20, 55);

                let yPosition = 75;
                const pageHeight = doc.internal.pageSize.height;
                const margin = 20;

                entries.forEach((entry, index) => {
                    // Check if we need a new page
                    if (yPosition > pageHeight - 60) {
                        doc.addPage();
                        yPosition = 30;
                    }

                    const entryDate = new Date(entry.timestamp);
                    const formattedDate = entryDate.toLocaleDateString('it-IT', { 
                        weekday: 'long', 
                        year: 'numeric', 
                        month: 'long', 
                        day: 'numeric',
                        hour: '2-digit',
                        minute: '2-digit'
                    });

                    // Entry header
                    doc.setFontSize(14);
                    doc.text(`Entry #${index + 1}`, margin, yPosition);
                    yPosition += 10;

                    doc.setFontSize(10);
                    doc.text(`Data: ${formattedDate}`, margin, yPosition);
                    yPosition += 8;
                    doc.text(`Autore: ${entry.author}`, margin, yPosition);
                    yPosition += 8;

                    if (entry.location) {
                        doc.text(`Luogo: ${entry.location}`, margin, yPosition);
                        yPosition += 8;
                    }

                    yPosition += 5;

                    // Entry content
                    doc.setFontSize(11);
                    const splitText = doc.splitTextToSize(entry.message, 170);
                    doc.text(splitText, margin, yPosition);
                    yPosition += splitText.length * 6 + 15;

                    // Separator line
                    doc.line(margin, yPosition, 190, yPosition);
                    yPosition += 15;
                });

                // Statistics
                if (yPosition > pageHeight - 80) {
                    doc.addPage();
                    yPosition = 30;
                }

                doc.setFontSize(14);
                doc.text('STATISTICHE DIARIO', margin, yPosition);
                yPosition += 15;

                doc.setFontSize(11);
                doc.text(`Totale entries: ${entries.length}`, margin, yPosition);
                yPosition += 8;
                doc.text(`Primo ricordo: ${new Date(entries[0].timestamp).toLocaleDateString('it-IT')}`, margin, yPosition);
                yPosition += 8;
                doc.text(`Ultimo ricordo: ${new Date(entries[entries.length - 1].timestamp).toLocaleDateString('it-IT')}`, margin, yPosition);

                // Save the PDF
                doc.save(`Diario_Sri_Lanka_${new Date().toISOString().split('T')[0]}.pdf`);

                // Show success message
                const button = document.querySelector('button[onclick="exportDiaryPDF()"]');
                if (button) {
                    const originalText = button.innerHTML;
                    button.innerHTML = '‚úÖ PDF scaricato!';
                    button.className = 'bg-green-600 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200 text-sm';
                    
                    setTimeout(() => {
                        button.innerHTML = originalText;
                        button.className = 'bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200 text-sm';
                    }, 3000);
                }

            } catch (error) {
                console.error('Errore nella generazione del PDF:', error);
                alert('Errore nella generazione del PDF. Prova con il download TXT.');
            }
        }

        // Load diary entries when page loads
        document.addEventListener('DOMContentLoaded', function() {
            // Initial load is handled when opening the modal
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'97307681552a92f5',t:'MTc1NTg0NTcwOS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
